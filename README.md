# Malware-Analysis-with-Sysinternal-Suite

PROJECT OBJECTIVE
The main goal of this project is to show how well the Sysinternals Suite—in particular, programs like Process Explorer and Process Monitor—may be used to identify, examine, and comprehend harmful software activity on Windows operating systems. The project's goal is to improve cybersecurity enthusiasts' and professionals' capacity to recognize questionable operations, comprehend malware behavior, and use this understanding to fortify system security defenses by employing these tools.

SKILLS LEARNED
•	Malware identification techniques
•	Data interpretation
•	Process analysis
•	Real time analysis
•	Reporting 

TOOLS
•	Process Explorer
•	Process Monitor

STEPS FOR DOING THE PROJECT

What to look for when analyzing the processes for malware:
•	Processes that have no name
•	Processes with no icon/image
•	Processes with no description or company name
•	Unsigned images
•	Processes residing in the Windows directory or User profile
•	Packed executables
•	Suspicious URLs
•	Processes with open TCP/IP connections
•	Suspicious DLLs or services hosted by processes


 STARTING THE PROCESS
1. Run Process Explorer:
  Open `procex64.exe` application located in the Sysinternals Suite folder. Alternatively, launch `procex64.exe` from the command prompt using the correct path to the file.

![image](https://github.com/Cipher-Rachael/Malware-Analysis-with-Sysinternal-Suite/assets/101173177/f3b399e5-3507-4b77-98d2-2576abf3325d)

![image](https://github.com/Cipher-Rachael/Malware-Analysis-with-Sysinternal-Suite/assets/101173177/343096bd-1720-485c-929c-b762fa00272d)

3. Options → Verify Image Signature:
  Verify image signatures of processes. Missing signatures indicate potential red flags.

4. Options → VirusTotal → Check virustotal.com:
 Click to check if running processes are legitimate. Pay attention to the numbers; they should ideally start with zero. Non-zero values may indicate suspicious activity.

Lets analyze the below process circles in red by clicking on the virus total number 2/72 to gain more info :

![image](https://github.com/Cipher-Rachael/Malware-Analysis-with-Sysinternal-Suite/assets/101173177/2f470767-00d1-421c-aa2a-85663681b773)

![image](https://github.com/Cipher-Rachael/Malware-Analysis-with-Sysinternal-Suite/assets/101173177/9aaf7ecd-21ad-445c-8d57-141eb08f7045)

•	2/72 security vendors: This indicates that out of 72 different antivirus engines used by VirusTotal to scan the file, only 2 of them flagged it as potentially malicious. In other words, only 2 antivirus programs detected the file as a threat.

•	No sandboxes flagged this file as malicious: Sandboxes are isolated environments used for safely executing and analyzing suspicious files without risking harm to the host system. In this case, none of the sandbox environments used by VirusTotal flagged the file as malicious. This could mean that the file doesn't exhibit obvious malicious behavior when executed in a controlled environment.

•	ClamAV Win.Virus.Expiro-10025927-0 detected: ClamAV, an open-source antivirus engine, specifically detected the file as Win.Virus.Expiro-10025927-0. This indicates that ClamAV identified the file as a variant of the Expiro virus, which is a type of malware known for infecting executable files on Windows systems.

Overall, these results suggest that while one antivirus engine (ClamAV) flagged the file as malicious, the majority of antivirus engines did not detect it as a threat. However, it's essential to exercise caution with files that are flagged by any antivirus program, as they may still pose a risk to your system. You may want to further investigate the file and its source to determine whether it's safe to keep on your computer.

4. View → Select Columns → Check "Show Command Line":**
 Enable the display of command-line information for processes.

5. Right-click on a Process → Properties:
•	Explore additional information such as:
•	Strings: Search for suspicious URLs.
•	Image: Locate the folder where the process is running.
•	TCP/IP: Check for open network connections.
•	Threads: View information about process threads.
•	Security: Examine process security settings.
•	Environment: Review process environment variables.
•	Performance: Analyze process performance metrics.

6. Run Process Monitor
 Open Command Prompt and type procmon.exe, then press Enter.

![image](https://github.com/Cipher-Rachael/Malware-Analysis-with-Sysinternal-Suite/assets/101173177/d9cf91a5-32e0-40e1-85b1-1c5b5a7b061f)

Process monitor will open

![image](https://github.com/Cipher-Rachael/Malware-Analysis-with-Sysinternal-Suite/assets/101173177/ca594580-f002-46b2-a665-fec69ee15653)


7. Filter Processes
•	Use Process Monitor to filter processes that seem suspicious or those you want to monitor closely.
•	Right-click on a row → Include, Exclude, etc. Click on Filtering icon for more complex filtering.
•	Example: Category = Write only shows modification activity, where malware is likely to appear.

8. Suspend or kill Malicious Activity
Identify suspicious processes in Process Monitor.
Right-click on the process and choose an appropriate action such as suspending or killing the process.

![image](https://github.com/Cipher-Rachael/Malware-Analysis-with-Sysinternal-Suite/assets/101173177/9f56fb9c-4e95-44b9-8fea-1bd41e166dab)

CONCLUSION
By following these steps and leveraging the features of Sysinternals Suite tools such as Process Explorer and Process Monitor, users can effectively identify and investigate potentially malicious processes on their systems. This project provides practical guidance for analyzing process attributes and behaviours to detect and mitigate malware threats.









